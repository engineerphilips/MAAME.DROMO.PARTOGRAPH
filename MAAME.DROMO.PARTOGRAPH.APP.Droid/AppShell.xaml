<?xml version="1.0" encoding="UTF-8" ?>
<Shell
    x:Class="MAAME.DROMO.PARTOGRAPH.APP.Droid.AppShell"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:pages="clr-namespace:MAAME.DROMO.PARTOGRAPH.APP.Droid.Pages"
    xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
    xmlns:sfSegment="clr-namespace:Syncfusion.Maui.Toolkit.SegmentedControl;assembly=Syncfusion.Maui.Toolkit"
    xmlns:sfBadge="clr-namespace:Syncfusion.Maui.Core;assembly=Syncfusion.Maui.Core"
    xmlns:mi="http://www.aathifmahir.com/dotnet/2022/maui/icons"
    xmlns:fonts="clr-namespace:Fonts"
    Shell.FlyoutBehavior="Flyout"
    Shell.FlyoutWidth="320"
    Shell.FlyoutBackgroundColor="{AppThemeBinding Light=White, Dark=#1A1A1A}"
    Title="Partograph Monitor">

    <Shell.Resources>
        <ResourceDictionary>
            <!-- Modern Base Style for Shell -->
            <Style x:Key="BaseStyle" TargetType="Element">
                <Setter Property="Shell.BackgroundColor" Value="{AppThemeBinding Light=White, Dark=#1A1A1A}" />
                <Setter Property="Shell.ForegroundColor" Value="{AppThemeBinding Light=#1A1A1A, Dark=#F5F5F5}" />
                <Setter Property="Shell.TitleColor" Value="{AppThemeBinding Light=#1A1A1A, Dark=#F5F5F5}" />
                <Setter Property="Shell.DisabledColor" Value="{AppThemeBinding Light=#B0BEC5, Dark=#546E7A}" />
                <Setter Property="Shell.UnselectedColor" Value="{AppThemeBinding Light=#78909C, Dark=#90A4AE}" />
                <Setter Property="Shell.TabBarBackgroundColor" Value="{AppThemeBinding Light=White, Dark=#1E1E1E}" />
                <Setter Property="Shell.TabBarForegroundColor" Value="{AppThemeBinding Light=#2196F3, Dark=#64B5F6}" />
                <Setter Property="Shell.TabBarUnselectedColor" Value="{AppThemeBinding Light=#9E9E9E, Dark=#757575}" />
                <Setter Property="Shell.TabBarTitleColor" Value="{AppThemeBinding Light=#2196F3, Dark=#64B5F6}" />
            </Style>

            <!-- Modern Flyout Item Style -->
            <Style x:Key="ModernFlyoutItemStyle" TargetType="FlyoutItem" BasedOn="{StaticResource BaseStyle}">
                <Setter Property="Shell.ItemTemplate">
                    <Setter.Value>
                        <DataTemplate>
                            <Grid ColumnDefinitions="Auto,*,Auto" 
                                  Padding="24,16" 
                                  BackgroundColor="Transparent">

                                <!-- Icon Container -->
                                <Border Grid.Column="0"
                                        WidthRequest="40"
                                        HeightRequest="40"
                                        BackgroundColor="{AppThemeBinding Light=#F5F7FA, Dark=#2A2A2A}"
                                        HorizontalOptions="Center"
                                        VerticalOptions="Center">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="12" />
                                    </Border.StrokeShape>

                                    <Image Source="{Binding FlyoutIcon}"
                                           WidthRequest="20"
                                           HeightRequest="20"
                                           HorizontalOptions="Center"
                                           VerticalOptions="Center" />
                                </Border>

                                <!-- Title -->
                                <Label Grid.Column="1"
                                       Text="{Binding Title}"
                                       FontSize="16"
                                       FontAttributes="Bold"
                                       TextColor="{AppThemeBinding Light=#1A1A1A, Dark=#F5F5F5}"
                                       VerticalOptions="Center"
                                       Margin="16,0,0,0" />

                                <!-- Active Indicator -->
                                <Border Grid.Column="2"
                                        WidthRequest="8"
                                        HeightRequest="8"
                                        BackgroundColor="#2196F3"
                                        IsVisible="{Binding IsSelected}"
                                        VerticalOptions="Center">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="4" />
                                    </Border.StrokeShape>
                                </Border>
                            </Grid>
                        </DataTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style TargetType="TabBar" BasedOn="{StaticResource BaseStyle}" />
            <Style TargetType="FlyoutItem" BasedOn="{StaticResource ModernFlyoutItemStyle}" />
        </ResourceDictionary>
    </Shell.Resources>

    <!-- Modern Flyout Header -->
    <Shell.FlyoutHeader>
        <Grid HeightRequest="280" BackgroundColor="{AppThemeBinding Light=White, Dark=#1A1A1A}">
            <Grid.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                    <GradientStop Color="{AppThemeBinding Light=#1565C0, Dark=#0D47A1}" Offset="0.0" />
                    <GradientStop Color="{AppThemeBinding Light=#1976D2, Dark=#1565C0}" Offset="0.3" />
                    <GradientStop Color="{AppThemeBinding Light=#2196F3, Dark=#1976D2}" Offset="0.7" />
                    <GradientStop Color="{AppThemeBinding Light=#42A5F5, Dark=#1E88E5}" Offset="1.0" />
                </LinearGradientBrush>
            </Grid.Background>

            <!-- Decorative Background Elements -->
            <!--<BoxView Color="#FFFFFF08"
                     WidthRequest="200"
                     HeightRequest="200"
                     CornerRadius="100"
                     HorizontalOptions="End"
                     VerticalOptions="Start"
                     Margin="0,-50,-50,0" />
            <BoxView Color="#FFFFFF05"
                     WidthRequest="150"
                     HeightRequest="150"
                     CornerRadius="75"
                     HorizontalOptions="Start"
                     VerticalOptions="End"
                     Margin="-40,-40,0,0" />-->

            <!-- Content Container -->
            <Grid VerticalOptions="Center" Margin="24,32,24,24">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <!-- User Greeting -->
                <!--<Label Grid.Row="0"
                       Text="{Binding Greeting}"
                       TextColor="#FFFFFFCC"
                       FontSize="14"
                       HorizontalOptions="Center"
                       Margin="0,0,0,8" />-->

                <!-- App Icon with Glow Effect -->
                <Border Grid.Row="1"
                        WidthRequest="72"
                        HeightRequest="72"
                        BackgroundColor="White"
                        HorizontalOptions="Center">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="22" />
                    </Border.StrokeShape>
                    <Border.Shadow>
                        <Shadow Brush="#40FFFFFF"
                                Offset="0,4"
                                Radius="16"
                                Opacity="0.3" />
                    </Border.Shadow>
                    <Label Text="&#xE95E;"
                           FontFamily="{x:Static fonts:FluentUI.FontFamily}"
                           FontSize="36"
                           TextColor="#1976D2"
                           HorizontalOptions="Center"
                           VerticalOptions="Center" />
                </Border>

                <!-- App Title -->
                <Label Grid.Row="2"
                       Text="Maame.Dromo"
                       TextColor="White"
                       FontSize="26"
                       FontAttributes="Bold"
                       HorizontalOptions="Center"
                       Margin="0,14,0,0" />

                <!-- App Subtitle -->
                <Label Grid.Row="3"
                       Text="Partograph Management System"
                       TextColor="White"
                       FontSize="13"
                       HorizontalOptions="Center"
                       Margin="0,4,0,0" />

                <!-- Version and Date Badge -->
                <HorizontalStackLayout Grid.Row="4"
                                       HorizontalOptions="Center"
                                       Spacing="10"
                                       Margin="0,14,0,0">
                    <!-- Version Badge BackgroundColor="#FFFFFF20"-->
                    <Border Padding="12,6">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="10" />
                        </Border.StrokeShape>
                        <HorizontalStackLayout Spacing="6">
                            <Label Text="&#xE735;"
                                   FontFamily="{x:Static fonts:FluentUI.FontFamily}"
                                   FontSize="12"
                                   TextColor="White"
                                   VerticalOptions="Center" />
                            <Label Text="{Binding AppVersion}"
                                   TextColor="White"
                                   FontSize="12"
                                   FontAttributes="Bold"
                                   VerticalOptions="Center" />
                        </HorizontalStackLayout>
                    </Border>

                    <!-- Date Badge BackgroundColor="#FFFFFF20"-->
                    <!--<Border Padding="12,6">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="10" />
                        </Border.StrokeShape>
                        <HorizontalStackLayout Spacing="6">
                            <Label Text="&#xE787;"
                                   FontFamily="{x:Static fonts:FluentUI.FontFamily}"
                                   FontSize="12"
                                   TextColor="White"
                                   VerticalOptions="Center" />
                            <Label Text="{Binding CurrentDate}"
                                   TextColor="White"
                                   FontSize="12"
                                   VerticalOptions="Center" />
                        </HorizontalStackLayout>
                    </Border>-->
                </HorizontalStackLayout>
            </Grid>
        </Grid>
    </Shell.FlyoutHeader>

    <!-- Enhanced Navigation Items -->
    <FlyoutItem Title="Home">
        <FlyoutItem.Icon>
            <FontImageSource FontFamily="{x:Static fonts:FluentUI.FontFamily}"
                             Glyph="{x:Static fonts:FluentUI.home_28_regular}"
                             Color="{AppThemeBinding Light=#2196F3, Dark=#64B5F6}"
                             Size="20" />
        </FlyoutItem.Icon>

        <ShellContent Title="Home" 
                      ContentTemplate="{DataTemplate pages:HomePage}"
                      Route="home" />
    </FlyoutItem>

    <FlyoutItem Title="Patients">
        <FlyoutItem.Icon>
            <FontImageSource FontFamily="{x:Static fonts:FluentUI.FontFamily}"
                             Glyph="{x:Static fonts:FluentUI.people_28_regular}"
                             Color="{AppThemeBinding Light=#2196F3, Dark=#64B5F6}"
                             Size="20" />
        </FlyoutItem.Icon>

        <ShellContent Title="Patients"
                      ContentTemplate="{DataTemplate pages:PatientsPage}"
                      Route="patients" />
    </FlyoutItem>

    <FlyoutItem Title="Reports">
        <FlyoutItem.Icon>
            <FontImageSource FontFamily="{x:Static fonts:FluentUI.FontFamily}"
                             Glyph="{x:Static fonts:FluentUI.document_folder_24_regular}"
                             Color="{AppThemeBinding Light=#2196F3, Dark=#64B5F6}"
                             Size="20" />
        </FlyoutItem.Icon>
        <ShellContent Title="Reports"
                      ContentTemplate="{DataTemplate pages:ReportsPage}"
                      Route="reports" />
    </FlyoutItem>

    <FlyoutItem Title="Facilities"
                x:Name="FacilitiesMenuItem"
                IsVisible="{Binding ShowFacilitiesMenu}">
        <FlyoutItem.Icon>
            <FontImageSource FontFamily="{x:Static fonts:FluentUI.FontFamily}"
                             Glyph="{x:Static fonts:FluentUI.building_32_regular}"
                             Color="{AppThemeBinding Light=#2196F3, Dark=#64B5F6}"
                             Size="20" /> 
        </FlyoutItem.Icon>
        <ShellContent Title="Facilities"
                      ContentTemplate="{DataTemplate pages:FacilityListPage}"
                      Route="facilities" />
    </FlyoutItem>

    <FlyoutItem Title="Users"
                x:Name="UsersMenuItem"
                IsVisible="{Binding ShowUsersMenu}">
        <FlyoutItem.Icon>
            <FontImageSource FontFamily="{x:Static fonts:FluentUI.FontFamily}"
                             Glyph="{x:Static fonts:FluentUI.person_24_regular}"
                             Color="{AppThemeBinding Light=#2196F3, Dark=#64B5F6}"
                             Size="20" />
        </FlyoutItem.Icon>
        <ShellContent Title="Users"
                      ContentTemplate="{DataTemplate pages:UsersPage}"
                      Route="users" />
    </FlyoutItem>

    <ShellContent
    x:Name="partograph"
    Route="partograph"
    Shell.FlyoutBehavior="Disabled"
    Shell.NavBarIsVisible="False"
    Shell.TabBarIsVisible="False"
    ContentTemplate="{DataTemplate pages:PartographPage}" />

    <!--<ShellContent
    x:Name="partographchart"
    Route="partographchart"
    Shell.FlyoutBehavior="Disabled"
    Shell.NavBarIsVisible="True"
    Shell.TabBarIsVisible="True"
    ContentTemplate="{DataTemplate pages:PartographChartPage}" />-->

    <!--<ShellContent
    x:Name="birthoutcome"
    Route="birthoutcome"
    Shell.FlyoutBehavior="Disabled"
    Shell.NavBarIsVisible="True"
    Shell.TabBarIsVisible="True"
    ContentTemplate="{DataTemplate pages:BirthOutcomePage}" />-->
    
    <!-- Divider -->
    <MenuFlyoutSeparator />

    <FlyoutItem Title="Help &amp; Support">
        <FlyoutItem.Icon>
            <FontImageSource FontFamily="{x:Static fonts:FluentUI.FontFamily}"
                             Glyph="&#xE897;"
                             Color="{AppThemeBinding Light=#757575, Dark=#BDBDBD}"
                             Size="20" />
        </FlyoutItem.Icon>
        <ShellContent Title="Help &amp; Support"
                      ContentTemplate="{DataTemplate pages:HelpPage}"
                      Route="help" />
    </FlyoutItem>

    <!--<FlyoutItem Title="Settings">
        <FlyoutItem.Icon>
            <FontImageSource FontFamily="{x:Static fonts:FluentUI.FontFamily}"
                             Glyph="&#xE713;"
                             Color="{AppThemeBinding Light=#757575, Dark=#BDBDBD}"
                             Size="20" />
        </FlyoutItem.Icon>
        <ShellContent Title="Settings"
                      ContentTemplate="{DataTemplate pages:SettingsPage}"
                      Route="settings" />
    </FlyoutItem>-->

    <!-- Modern Flyout Footer -->
    <Shell.FlyoutFooter>
        <Border BackgroundColor="{AppThemeBinding Light=#FAFAFA, Dark=#1E1E1E}"
                Padding="20,16"
                Margin="0">
            <Border.StrokeShape>
                <RoundRectangle CornerRadius="0" />
            </Border.StrokeShape>

            <Grid RowDefinitions="Auto,Auto,Auto,Auto,Auto" RowSpacing="14">

                <!-- Quick Stats Section -->
                <!--<Grid Grid.Row="0"
                      ColumnDefinitions="*,*"
                      ColumnSpacing="10"
                      IsVisible="{Binding ShowUserDetails}">
                    --><!-- Active Patients Stat --><!--
                    <Border Grid.Column="0"
                            BackgroundColor="{AppThemeBinding Light=#E8F5E9, Dark=#1B3D26}"
                            Padding="12,10">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="12" />
                        </Border.StrokeShape>
                        <Border.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding ViewActiveCommand}" />
                        </Border.GestureRecognizers>
                        <VerticalStackLayout Spacing="4">
                            <HorizontalStackLayout Spacing="6">
                                <Label Text="&#xE823;"
                                       FontFamily="{x:Static fonts:FluentUI.FontFamily}"
                                       FontSize="16"
                                       TextColor="#4CAF50"
                                       VerticalOptions="Center" />
                                <Label Text="Active"
                                       FontSize="12"
                                       TextColor="{AppThemeBinding Light=#666, Dark=#AAA}"
                                       VerticalOptions="Center" />
                            </HorizontalStackLayout>
                            <Label Text="{Binding ActivePatientsDisplay}"
                                   FontSize="24"
                                   FontAttributes="Bold"
                                   TextColor="#2E7D32" />
                        </VerticalStackLayout>
                    </Border>

                    --><!-- Pending Patients Stat --><!--
                    <Border Grid.Column="1"
                            BackgroundColor="{AppThemeBinding Light=#FFF3E0, Dark=#3D2E1B}"
                            Padding="12,10">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="12" />
                        </Border.StrokeShape>
                        <Border.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding ViewPendingCommand}" />
                        </Border.GestureRecognizers>
                        <VerticalStackLayout Spacing="4">
                            <HorizontalStackLayout Spacing="6">
                                <Label Text="&#xE823;"
                                       FontFamily="{x:Static fonts:FluentUI.FontFamily}"
                                       FontSize="16"
                                       TextColor="#FF9800"
                                       VerticalOptions="Center" />
                                <Label Text="Pending"
                                       FontSize="12"
                                       TextColor="{AppThemeBinding Light=#666, Dark=#AAA}"
                                       VerticalOptions="Center" />
                            </HorizontalStackLayout>
                            <Label Text="{Binding PendingPatientsDisplay}"
                                   FontSize="24"
                                   FontAttributes="Bold"
                                   TextColor="#E65100" />
                        </VerticalStackLayout>
                    </Border>
                </Grid>-->

                <!-- Theme Switcher Section -->
                <VerticalStackLayout Grid.Row="1" Spacing="8">
                    <HorizontalStackLayout Spacing="8">
                        <Label Text="&#xE7F4;"
                               FontFamily="{x:Static fonts:FluentUI.FontFamily}"
                               FontSize="14"
                               TextColor="{AppThemeBinding Light=#666, Dark=#AAA}"
                               VerticalOptions="Center" />
                        <Label Text="Appearance"
                               FontSize="12"
                               TextColor="{AppThemeBinding Light=#888, Dark=#999}" />
                    </HorizontalStackLayout>

                    <sfSegment:SfSegmentedControl x:Name="ThemeSegmentedControl"
                                                 SelectionChanged="SfSegmentedControl_SelectionChanged"
                                                 CornerRadius="12"
                                                 HeightRequest="40"
                                                 BackgroundColor="{AppThemeBinding Light=#F0F0F0, Dark=#2A2A2A}">
                        <sfSegment:SfSegmentedControl.ItemsSource>
                            <x:Array Type="{x:Type x:String}">
                                <x:String>Light</x:String>
                                <x:String>Dark</x:String>
                            </x:Array>
                        </sfSegment:SfSegmentedControl.ItemsSource>
                    </sfSegment:SfSegmentedControl>
                </VerticalStackLayout>

                <!-- Divider -->
                <BoxView Grid.Row="2"
                         HeightRequest="1"
                         Color="{AppThemeBinding Light=#E8E8E8, Dark=#333333}" />

                <!-- User Profile Section -->
                <Grid Grid.Row="3" ColumnDefinitions="Auto,*,Auto" ColumnSpacing="12">
                    <!-- Profile Avatar with Initials -->
                    <Border Grid.Column="0"
                            WidthRequest="50"
                            HeightRequest="50"
                            BackgroundColor="{Binding AvatarColor}">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="25" />
                        </Border.StrokeShape>
                        <Border.Shadow>
                            <Shadow Brush="#2196F3"
                                    Offset="0,2"
                                    Radius="6"
                                    Opacity="0.2" />
                        </Border.Shadow>
                        <Label Text="{Binding UserInitials}"
                               FontSize="18"
                               FontAttributes="Bold" 
                               HorizontalOptions="Center"
                               VerticalOptions="Center" />
                    </Border>

                    <!-- User Info -->
                    <VerticalStackLayout Grid.Column="1" VerticalOptions="Center" Spacing="2">
                        <Label Text="{Binding Name}"
                               FontAttributes="Bold"
                               FontSize="15"
                               TextColor="{AppThemeBinding Light=#1A1A1A, Dark=#F5F5F5}"
                               LineBreakMode="TailTruncation" />
                        <Label Text="{Binding Role}"
                               FontSize="12"
                               TextColor="{AppThemeBinding Light=#666, Dark=#AAA}" />

                        <!-- Status Badge -->
                        <Label Text="{Binding Facility}"
                               FontSize="12"
                               TextColor="{AppThemeBinding Light=#666, Dark=#AAA}"
                               LineBreakMode="TailTruncation"/>
                        
                        <!--<Border BackgroundColor="{AppThemeBinding Light=#E8F5E9, Dark=#1B3D26}"
                                Padding="8,3"
                                Margin="0,3,0,0"
                                HorizontalOptions="Start">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="6" />
                            </Border.StrokeShape>
                            <HorizontalStackLayout Spacing="4">
                                <BoxView WidthRequest="6"
                                         HeightRequest="6"
                                         CornerRadius="3"
                                         Color="#4CAF50"
                                         VerticalOptions="Center" />
                                <Label Text="On Duty"
                                       FontSize="10"
                                       FontAttributes="Bold"
                                       TextColor="#2E7D32" />
                            </HorizontalStackLayout>
                        </Border>-->
                    </VerticalStackLayout>

                    <!-- Logout Button -->
                    <Border Grid.Column="2"
                            WidthRequest="42"
                            HeightRequest="42"
                            BackgroundColor="{AppThemeBinding Light=#FFEBEE, Dark=#3D1F1F}"
                            VerticalOptions="Center">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="12" />
                        </Border.StrokeShape>
                        <Border.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding LogoutCommand}" />
                        </Border.GestureRecognizers>
                        <Label Text="&#xE8BB;"
                               FontFamily="{x:Static fonts:FluentUI.FontFamily}"
                               FontSize="18"
                               TextColor="#EF5350"
                               HorizontalOptions="Center"
                               VerticalOptions="Center" />
                    </Border>
                </Grid>

                <!-- Made with love in Ghana -->
                <HorizontalStackLayout Grid.Row="4"
                                       Spacing="6"
                                       HorizontalOptions="Center"
                                       Margin="0,4,0,0">
                    <Label Text="Made with"
                           FontSize="12"
                           TextColor="{AppThemeBinding Light=#888, Dark=#777}"
                           VerticalOptions="Center" />
                    <Label Text="â¤ï¸"
                           FontSize="12"
                           VerticalOptions="Center" />
                    <Label Text="in Ghana"
                           FontSize="12"
                           TextColor="{AppThemeBinding Light=#888, Dark=#777}"
                           VerticalOptions="Center" />
                    <Label Text="ðŸ‡¬ðŸ‡­"
                           FontSize="14"
                           VerticalOptions="Center" />
                </HorizontalStackLayout>
            </Grid>
        </Border>
    </Shell.FlyoutFooter>

    <!-- Custom Title View for Modern Navigation Bar -->
    <Shell.TitleView>
        <Grid ColumnDefinitions="*,Auto,Auto,Auto"
              Padding="16,8"
              BackgroundColor="{AppThemeBinding Light=White, Dark=#1A1A1A}">

            <!-- Page Title with Breadcrumb and Facility Indicator -->
            <VerticalStackLayout Grid.Column="0"
                                 VerticalOptions="Center"
                                 Margin="8,0,0,0">
                <Label Text="{Binding Path=CurrentPage.Title, Source={RelativeSource AncestorType={x:Type Shell}}}"
                       FontSize="16"
                       FontAttributes="Bold"
                       TextColor="{AppThemeBinding Light=#1A1A1A, Dark=#F5F5F5}" />

                <!-- Facility Indicator -->
                <!--<HorizontalStackLayout Spacing="6">
                    <Label Text="&#xE80F;"
                           FontFamily="{x:Static fonts:FluentUI.FontFamily}"
                           FontSize="12"
                           TextColor="{AppThemeBinding Light=#2196F3, Dark=#64B5F6}"
                           VerticalOptions="Center" />
                    <Label Text="{Binding Facility}"
                           FontSize="13"
                           TextColor="{AppThemeBinding Light=#666, Dark=#AAA}"
                           VerticalOptions="Center" />
                </HorizontalStackLayout>-->
            </VerticalStackLayout>

            <!-- Quick Stats Indicator -->
            <!--<HorizontalStackLayout Grid.Column="1"
                                   Spacing="12"
                                   VerticalOptions="Center"
                                   Margin="0,0,8,0">
                --><!-- Active Patients Badge --><!--
                <Border BackgroundColor="{AppThemeBinding Light=#E8F5E9, Dark=#1B3D26}"
                        Padding="10,6"
                        IsVisible="{Binding ShowUserDetails}">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="12" />
                    </Border.StrokeShape>
                    <Border.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding ViewActiveCommand}" />
                    </Border.GestureRecognizers>
                    <HorizontalStackLayout Spacing="6">
                        <Label Text="&#xE823;"
                               FontFamily="{x:Static fonts:FluentUI.FontFamily}"
                               FontSize="14"
                               TextColor="#4CAF50"
                               VerticalOptions="Center" />
                        <Label Text="{Binding ActivePatientsDisplay}"
                               FontSize="13"
                               FontAttributes="Bold"
                               TextColor="#2E7D32"
                               VerticalOptions="Center" />
                        <Label Text="Active"
                               FontSize="11"
                               TextColor="{AppThemeBinding Light=#666, Dark=#AAA}"
                               VerticalOptions="Center" />
                    </HorizontalStackLayout>
                </Border>

                --><!-- Pending Patients Badge --><!--
                <Border BackgroundColor="{AppThemeBinding Light=#FFF3E0, Dark=#3D2E1B}"
                        Padding="10,6"
                        IsVisible="{Binding ShowUserDetails}">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="12" />
                    </Border.StrokeShape>
                    <Border.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding ViewPendingCommand}" />
                    </Border.GestureRecognizers>
                    <HorizontalStackLayout Spacing="6">
                        <Label Text="&#xE823;"
                               FontFamily="{x:Static fonts:FluentUI.FontFamily}"
                               FontSize="14"
                               TextColor="#FF9800"
                               VerticalOptions="Center" />
                        <Label Text="{Binding PendingPatientsDisplay}"
                               FontSize="13"
                               FontAttributes="Bold"
                               TextColor="#E65100"
                               VerticalOptions="Center" />
                        <Label Text="Pending"
                               FontSize="11"
                               TextColor="{AppThemeBinding Light=#666, Dark=#AAA}"
                               VerticalOptions="Center" />
                    </HorizontalStackLayout>
                </Border>
            </HorizontalStackLayout>-->

            <!-- Notifications Button with Syncfusion Badge -->
            <sfBadge:SfBadgeView Grid.Column="2"
                                 Margin="4,0"
                                 BadgeText="{Binding NotificationCountDisplay}"
                                 HorizontalOptions="Center"
                                 VerticalOptions="Center">
                <sfBadge:SfBadgeView.BadgeSettings>
                    <sfBadge:BadgeSettings Type="None"
                                           Background="#EF5350"
                                           TextColor="White"
                                           FontSize="10"
                                           FontAttributes="Bold"
                                           Position="TopRight"
                                           Offset="-8,0"
                                           CornerRadius="10"
                                           Animation="Scale" />
                </sfBadge:SfBadgeView.BadgeSettings>
                <sfBadge:SfBadgeView.Triggers>
                    <DataTrigger TargetType="sfBadge:SfBadgeView"
                                 Binding="{Binding HasNotifications}"
                                 Value="False">
                        <Setter Property="BadgeText" Value="" />
                    </DataTrigger>
                </sfBadge:SfBadgeView.Triggers>
                <Button Command="{Binding ShowNotificationsCommand}"
                        BackgroundColor="Transparent"
                        TextColor="{AppThemeBinding Light=#666, Dark=#AAA}"
                        WidthRequest="48"
                        HeightRequest="48"
                        CornerRadius="24"
                        ToolTipProperties.Text="Notifications"
                        FontSize="18">
                    <Button.ImageSource>
                         <FontImageSource FontFamily="{x:Static fonts:FluentUI.FontFamily}"
                                          Glyph="&#xf115;"
                                          Color="{AppThemeBinding Light=#64748B, Dark=#94A3B8}"
                                          Size="24" />
                    </Button.ImageSource>
                    <Button.Triggers>
                        <Trigger TargetType="Button" Property="IsPressed" Value="True">
                            <Setter Property="BackgroundColor" Value="{AppThemeBinding Light=#F5F5F5, Dark=#2A2A2A}" />
                        </Trigger>
                    </Button.Triggers>
                </Button>
            </sfBadge:SfBadgeView>

            <!-- Help Button -->
            <Grid Grid.Column="3" Margin="4,0">
                <Button Command="{Binding OpenHelpCommand}"
                        BackgroundColor="Transparent"
                        TextColor="{AppThemeBinding Light=#666, Dark=#AAA}"
                        WidthRequest="48"
                        HeightRequest="48"
                        CornerRadius="24"
                        ToolTipProperties.Text="Help &amp; Support">
                    <Button.ImageSource>
                         <FontImageSource FontFamily="{x:Static fonts:FluentUI.FontFamily}" 
                                          Glyph="&#xf63e;" 
                                          Color="{AppThemeBinding Light=#64748B, Dark=#94A3B8}" 
                                          Size="24" />
                    </Button.ImageSource>
                    <Button.Triggers>
                        <Trigger TargetType="Button" Property="IsPressed" Value="True">
                            <Setter Property="BackgroundColor" Value="{AppThemeBinding Light=#F5F5F5, Dark=#2A2A2A}" />
                        </Trigger>
                    </Button.Triggers>
                </Button>
            </Grid>
        </Grid>
    </Shell.TitleView>

</Shell>
