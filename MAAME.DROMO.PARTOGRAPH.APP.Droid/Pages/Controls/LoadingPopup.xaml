<?xml version="1.0" encoding="utf-8" ?>
<toolkit:Popup xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
               xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
               xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
               xmlns:fonts="clr-namespace:Fonts"
               x:Class="MAAME.DROMO.PARTOGRAPH.APP.Droid.Pages.Controls.LoadingPopup"
               CanBeDismissedByTappingOutsideOfPopup="False"
               Color="Transparent">

    <Border BackgroundColor="{AppThemeBinding Light=White, Dark=#2D2D2D}"
            Padding="30,25"
            MinimumWidthRequest="280"
            HorizontalOptions="Center"
            VerticalOptions="Center">
        <Border.StrokeShape>
            <RoundRectangle CornerRadius="16" />
        </Border.StrokeShape>
        <Border.Shadow>
            <Shadow Brush="Black" Offset="0,8" Radius="20" Opacity="0.25" />
        </Border.Shadow>

        <VerticalStackLayout Spacing="18" HorizontalOptions="Center">
            <!-- Animated Icon -->
            <Border x:Name="IconBorder"
                    WidthRequest="60"
                    HeightRequest="60"
                    BackgroundColor="{AppThemeBinding Light=#E3F2FD, Dark=#1565C0}"
                    HorizontalOptions="Center">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="30" />
                </Border.StrokeShape>
                <Label x:Name="IconLabel"
                       Text="&#xE95E;"
                       FontFamily="{x:Static fonts:FluentUI.FontFamily}"
                       FontSize="28"
                       TextColor="#2196F3"
                       HorizontalOptions="Center"
                       VerticalOptions="Center" />
            </Border>

            <!-- Loading Message -->
            <Label x:Name="MessageLabel"
                   Text="Loading..."
                   FontSize="16"
                   FontAttributes="Bold"
                   TextColor="{AppThemeBinding Light=#1976D2, Dark=#64B5F6}"
                   HorizontalOptions="Center"
                   HorizontalTextAlignment="Center" />

            <!-- Progress Bar Container -->
            <Grid x:Name="ProgressContainer"
                  IsVisible="False"
                  WidthRequest="220"
                  HeightRequest="24">
                <!-- Progress Bar Background -->
                <Border BackgroundColor="{AppThemeBinding Light=#E0E0E0, Dark=#424242}"
                        HeightRequest="8"
                        VerticalOptions="Center">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="4" />
                    </Border.StrokeShape>
                </Border>

                <!-- Progress Bar Fill -->
                <Border x:Name="ProgressFill"
                        BackgroundColor="#2196F3"
                        HeightRequest="8"
                        HorizontalOptions="Start"
                        VerticalOptions="Center"
                        WidthRequest="0">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="4" />
                    </Border.StrokeShape>
                </Border>

                <!-- Progress Percentage Label -->
                <Label x:Name="ProgressPercentLabel"
                       Text="0%"
                       FontSize="11"
                       FontAttributes="Bold"
                       TextColor="{AppThemeBinding Light=#1976D2, Dark=#64B5F6}"
                       HorizontalOptions="End"
                       VerticalOptions="End"
                       Margin="0,0,0,-2" />
            </Grid>

            <!-- Activity Indicator (for indeterminate loading) -->
            <ActivityIndicator x:Name="IndeterminateIndicator"
                               IsRunning="True"
                               Color="#2196F3"
                               HeightRequest="36"
                               WidthRequest="36"
                               HorizontalOptions="Center" />

            <!-- Sub Message -->
            <Label x:Name="SubMessageLabel"
                   Text="Please wait..."
                   FontSize="13"
                   TextColor="{AppThemeBinding Light=#666, Dark=#AAA}"
                   HorizontalOptions="Center"
                   HorizontalTextAlignment="Center" />
        </VerticalStackLayout>
    </Border>

</toolkit:Popup>
