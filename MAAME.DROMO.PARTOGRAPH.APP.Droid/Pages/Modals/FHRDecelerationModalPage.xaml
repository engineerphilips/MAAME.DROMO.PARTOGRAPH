<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MAAME.DROMO.PARTOGRAPH.APP.Droid.Pages.Modals.FHRDecelerationModalPage"
             Title="FHR Decelerations"
             BackgroundColor="#F5F5F5">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="15">

            <!-- Header -->
            <Border BackgroundColor="#FF5722" Padding="15">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="10" />
                </Border.StrokeShape>
                <Label Text="Record FHR Decelerations (Every 30 Minutes)" 
                       TextColor="White" 
                       FontSize="18" 
                       FontAttributes="Bold"
                       HorizontalTextAlignment="Center"/>
            </Border>

            <!-- Recording Time -->
            <Border BackgroundColor="White" Padding="10">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="5" />
                </Border.StrokeShape>
                <VerticalStackLayout>
                    <Label Text="Recording Time" FontAttributes="Bold"/>
                    <DatePicker Date="{Binding RecordingDate, Converter={StaticResource DateOnlyToDateTimeConverter}}" />
                    <TimePicker Time="{Binding RecordingTime}" />
                </VerticalStackLayout>
            </Border>

            <!-- Decelerations Present -->
            <Border BackgroundColor="White" Padding="10">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="5" />
                </Border.StrokeShape>
                <HorizontalStackLayout>
                    <CheckBox IsChecked="{Binding DecelerationsPresent}" />
                    <Label Text="Decelerations Present" VerticalOptions="Center" FontAttributes="Bold"/>
                </HorizontalStackLayout>
            </Border>

            <!-- Deceleration Details (shown if present) -->
            <Border BackgroundColor="White" Padding="10" IsVisible="{Binding DecelerationsPresent}">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="5" />
                </Border.StrokeShape>
                <VerticalStackLayout Spacing="10">

                    <!-- Type -->
                    <VerticalStackLayout>
                        <Label Text="Type of Deceleration" FontAttributes="Bold"/>
                        <Picker ItemsSource="{Binding DecelerationTypes}"
                                SelectedItem="{Binding SelectedDecelerationType}"/>
                    </VerticalStackLayout>

                    <!-- Severity -->
                    <VerticalStackLayout>
                        <Label Text="Severity" FontAttributes="Bold"/>
                        <RadioButton Content="Mild" GroupName="Severity" IsChecked="{Binding IsMild}"/>
                        <RadioButton Content="Moderate" GroupName="Severity" IsChecked="{Binding IsModerate}"/>
                        <RadioButton Content="Severe" GroupName="Severity" IsChecked="{Binding IsSevere}"/>
                    </VerticalStackLayout>

                    <!-- Duration -->
                    <VerticalStackLayout>
                        <Label Text="Duration (seconds)" FontAttributes="Bold"/>
                        <Entry Text="{Binding Duration}" 
                               Placeholder="Enter duration in seconds"
                               Keyboard="Numeric"/>
                    </VerticalStackLayout>

                    <!-- Recovery -->
                    <VerticalStackLayout>
                        <Label Text="Recovery" FontAttributes="Bold"/>
                        <Picker ItemsSource="{Binding RecoveryOptions}"
                                SelectedItem="{Binding SelectedRecovery}"/>
                    </VerticalStackLayout>

                    <!-- Action Required -->
                    <HorizontalStackLayout>
                        <CheckBox IsChecked="{Binding RequiresAction}" />
                        <Label Text="Action Required" VerticalOptions="Center" FontAttributes="Bold"/>
                    </HorizontalStackLayout>

                    <!-- Action Taken -->
                    <VerticalStackLayout IsVisible="{Binding RequiresAction}">
                        <Label Text="Action Taken" FontAttributes="Bold"/>
                        <Editor Text="{Binding ActionTaken}" 
                                Placeholder="Describe actions taken..."
                                HeightRequest="80"/>
                    </VerticalStackLayout>

                </VerticalStackLayout>
            </Border>

            <!-- Notes -->
            <Border BackgroundColor="White" Padding="10">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="5" />
                </Border.StrokeShape>
                <VerticalStackLayout>
                    <Label Text="Additional Notes" FontAttributes="Bold"/>
                    <Editor Text="{Binding Notes}" 
                            Placeholder="Enter any additional observations..."
                            HeightRequest="100"/>
                </VerticalStackLayout>
            </Border>

            <!-- Warning Message -->
            <Border BackgroundColor="#FFEB3B" Padding="10" IsVisible="{Binding ShowWarning}">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="5" />
                </Border.StrokeShape>
                <Label Text="{Binding WarningMessage}" 
                       TextColor="#B71C1C"
                       FontAttributes="Bold"/>
            </Border>

            <!-- Action Buttons -->
            <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                <Button Text="Cancel" 
                        Command="{Binding CancelCommand}"
                        BackgroundColor="#9E9E9E"
                        TextColor="White"
                        Grid.Column="0"/>
                <Button Text="Save" 
                        Command="{Binding SaveCommand}"
                        BackgroundColor="#4CAF50"
                        TextColor="White"
                        Grid.Column="1"/>
            </Grid>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>