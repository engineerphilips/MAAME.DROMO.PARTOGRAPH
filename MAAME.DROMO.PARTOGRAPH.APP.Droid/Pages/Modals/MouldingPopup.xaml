<?xml version="1.0" encoding="utf-8" ?>
<sfPopup:SfPopup xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:sfPopup="clr-namespace:Syncfusion.Maui.Popup;assembly=Syncfusion.Maui.Popup"
             xmlns:core="clr-namespace:Syncfusion.Maui.Core;assembly=Syncfusion.Maui.Core"
             xmlns:buttons="clr-namespace:Syncfusion.Maui.Buttons;assembly=Syncfusion.Maui.Buttons"
             x:Class="MAAME.DROMO.PARTOGRAPH.APP.Droid.Pages.Modals.MouldingPopup">

    <sfPopup:SfPopup.Resources>
        <ResourceDictionary>
            <!-- Input Styles -->
            <Style x:Key="PatientInput" TargetType="core:SfTextInputLayout">
                <Setter Property="ContainerType" Value="Outlined" />
                <Setter Property="OutlineCornerRadius" Value="8" />
            </Style>
        </ResourceDictionary>
    </sfPopup:SfPopup.Resources>
    <sfPopup:SfPopup.HeaderTemplate>
        <DataTemplate>
            <StackLayout>
                <Label Text="Moulding" VerticalOptions="Center" Margin="15,15,0,0" />
            </StackLayout>
        </DataTemplate>
    </sfPopup:SfPopup.HeaderTemplate>
    <sfPopup:SfPopup.ContentTemplate>
        <DataTemplate>
            <ScrollView>
                <VerticalStackLayout Padding="15,10" Spacing="10">
                    <core:SfTextInputLayout Hint="Date"
                                        Style="{StaticResource PatientInput}"
                                        HelperText="Recording time">
                        <DatePicker Date="{Binding RecordingDate}" />
                    </core:SfTextInputLayout>

                    <core:SfTextInputLayout Hint="Time"
                                        Style="{StaticResource PatientInput}"
                                        HelperText="Recording time">
                        <TimePicker Time="{Binding RecordingTime}" />
                    </core:SfTextInputLayout>

                    <VerticalStackLayout Padding="10,0,0,0">
                        <Label Text="What is the moulding?" FontAttributes="Bold"/>

                        <buttons:SfSegmentedControl x:Name="segmentedControl" CornerRadius="8" Margin="-10,0,0,0" VisibleSegmentsCount="4" SelectedIndex="{Binding DegreeIndex, Mode=TwoWay}">
                            <buttons:SfSegmentedControl.ItemsSource>
                                <x:Array Type="{x:Type x:String}">
                                    <x:String>0</x:String>
                                    <x:String>+</x:String>
                                    <x:String>++</x:String>
                                    <x:String>+++</x:String>
                                </x:Array>
                            </buttons:SfSegmentedControl.ItemsSource>
                        </buttons:SfSegmentedControl>
                    </VerticalStackLayout>

                    <core:SfTextInputLayout Hint="Additional Notes"
                                        Style="{StaticResource PatientInput}"
                                        HelperText="Any other observations...">
                        <Entry Text="{Binding Notes}"
                           Keyboard="Text"
                           ReturnType="Next" />
                    </core:SfTextInputLayout>

                    <!-- WHO 2020 Enhanced Assessment -->
                    <Label Text="WHO 2020 Detailed Assessment" FontAttributes="Bold" FontSize="16" Margin="0,15,0,5"/>

                    <Label Text="Suture Assessment" FontAttributes="Bold" Margin="0,10,0,5"/>
                    <Grid ColumnDefinitions="*,*" ColumnSpacing="10" RowDefinitions="Auto,Auto" RowSpacing="10">
                        <VerticalStackLayout Grid.Row="0" Grid.Column="0">
                            <Label Text="Sutures Overlapping"/>
                            <Switch IsToggled="{Binding SuturesOverlapping}" HorizontalOptions="Start"/>
                        </VerticalStackLayout>
                        <VerticalStackLayout Grid.Row="0" Grid.Column="1">
                            <Label Text="Reducible"/>
                            <Switch IsToggled="{Binding Reducible}" HorizontalOptions="Start"/>
                        </VerticalStackLayout>
                    </Grid>

                    <core:SfTextInputLayout Hint="Location"
                                        Style="{StaticResource PatientInput}"
                                        HelperText="Anatomical location">
                        <Entry Text="{Binding Location}" Keyboard="Text" />
                    </core:SfTextInputLayout>

                    <Label Text="Affected Sutures" FontAttributes="Bold" Margin="0,10,0,5"/>
                    <Grid ColumnDefinitions="*,*,*" ColumnSpacing="10">
                        <VerticalStackLayout Grid.Column="0">
                            <Label Text="Sagittal"/>
                            <Switch IsToggled="{Binding SagittalSuture}" HorizontalOptions="Start"/>
                        </VerticalStackLayout>
                        <VerticalStackLayout Grid.Column="1">
                            <Label Text="Coronal"/>
                            <Switch IsToggled="{Binding CoronalSuture}" HorizontalOptions="Start"/>
                        </VerticalStackLayout>
                        <VerticalStackLayout Grid.Column="2">
                            <Label Text="Lambdoid"/>
                            <Switch IsToggled="{Binding LambdoidSuture}" HorizontalOptions="Start"/>
                        </VerticalStackLayout>
                    </Grid>

                    <core:SfTextInputLayout Hint="Severity"
                                        Style="{StaticResource PatientInput}"
                                        HelperText="Mild, Moderate, Severe">
                        <Entry Text="{Binding Severity}" Keyboard="Text" />
                    </core:SfTextInputLayout>

                    <Label Text="Progression" FontAttributes="Bold" Margin="0,10,0,5"/>
                    <Grid ColumnDefinitions="*,*,*" ColumnSpacing="10">
                        <VerticalStackLayout Grid.Column="0">
                            <Label Text="Increasing"/>
                            <Switch IsToggled="{Binding Increasing}" HorizontalOptions="Start"/>
                        </VerticalStackLayout>
                        <VerticalStackLayout Grid.Column="1">
                            <Label Text="Reducing"/>
                            <Switch IsToggled="{Binding Reducing}" HorizontalOptions="Start"/>
                        </VerticalStackLayout>
                        <VerticalStackLayout Grid.Column="2">
                            <Label Text="Stable"/>
                            <Switch IsToggled="{Binding Stable}" HorizontalOptions="Start"/>
                        </VerticalStackLayout>
                    </Grid>

                    <core:SfTextInputLayout Hint="Progression Rate"
                                        Style="{StaticResource PatientInput}"
                                        HelperText="Rate of change">
                        <Entry Text="{Binding ProgressionRate}" Keyboard="Text" />
                    </core:SfTextInputLayout>

                    <core:SfTextInputLayout Hint="First Detected (Date/Time)"
                                        Style="{StaticResource PatientInput}"
                                        HelperText="When first detected">
                        <DatePicker Date="{Binding FirstDetectedTime}" />
                    </core:SfTextInputLayout>

                    <core:SfTextInputLayout Hint="Duration (Hours)"
                                        Style="{StaticResource PatientInput}"
                                        HelperText="Duration in hours">
                        <Entry Text="{Binding DurationHours}" Keyboard="Numeric" />
                    </core:SfTextInputLayout>

                    <Label Text="Caput Assessment" FontAttributes="Bold" Margin="0,10,0,5"/>
                    <Grid ColumnDefinitions="Auto,*" ColumnSpacing="10">
                        <Label Grid.Column="0" Text="Caput Present" VerticalOptions="Center"/>
                        <Switch Grid.Column="1" IsToggled="{Binding CaputPresent}" HorizontalOptions="Start"/>
                    </Grid>

                    <core:SfTextInputLayout Hint="Caput Degree"
                                        Style="{StaticResource PatientInput}"
                                        HelperText="0, +, ++, +++">
                        <Entry Text="{Binding CaputDegree}" Keyboard="Text" />
                    </core:SfTextInputLayout>

                    <Label Text="Clinical Indicators" FontAttributes="Bold" Margin="0,10,0,5"/>
                    <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                        <VerticalStackLayout Grid.Column="0">
                            <Label Text="Suggests Obstruction"/>
                            <Switch IsToggled="{Binding SuggestsObstruction}" HorizontalOptions="Start"/>
                        </VerticalStackLayout>
                        <VerticalStackLayout Grid.Column="1">
                            <Label Text="Suggests CPD"/>
                            <Switch IsToggled="{Binding SuggestsCPD}" HorizontalOptions="Start"/>
                        </VerticalStackLayout>
                    </Grid>

                    <core:SfTextInputLayout Hint="Change From Previous"
                                        Style="{StaticResource PatientInput}"
                                        HelperText="Describe changes">
                        <Entry Text="{Binding ChangeFromPrevious}" Keyboard="Text" />
                    </core:SfTextInputLayout>

                    <core:SfTextInputLayout Hint="Clinical Alert"
                                        Style="{StaticResource PatientInput}"
                                        HelperText="Any alerts or concerns"
                                        ContainerBackground="LightYellow">
                        <Entry Text="{Binding ClinicalAlert}" Keyboard="Text" />
                    </core:SfTextInputLayout>

                    <!-- Action Buttons -->
                    <Grid ColumnDefinitions="*,*" ColumnSpacing="15" Margin="0,20,0,40">
                        <Button Grid.Column="0"
                            Text="Cancel"
                            Command="{Binding CancelCommand}"
                            BackgroundColor="{AppThemeBinding Light=#E0E0E0, Dark=#424242}"
                            TextColor="{AppThemeBinding Light=#333, Dark=White}"
                            HeightRequest="50"
                            CornerRadius="10" />

                        <Button Grid.Column="1"
                            Text="Save Assessment"
                            Command="{Binding SaveCommand}"
                            BackgroundColor="#4CAF50"
                            TextColor="White"
                            HeightRequest="50"
                            CornerRadius="10" />
                    </Grid>

                </VerticalStackLayout>
            </ScrollView>
        </DataTemplate>
    </sfPopup:SfPopup.ContentTemplate>

</sfPopup:SfPopup>
