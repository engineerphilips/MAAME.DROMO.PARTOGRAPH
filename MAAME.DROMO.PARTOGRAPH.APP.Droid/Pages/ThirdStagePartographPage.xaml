<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MAAME.DROMO.PARTOGRAPH.APP.Droid.Pages.ThirdStagePartographPage"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             xmlns:fonts="clr-namespace:Fonts"
             xmlns:converters="clr-namespace:MAAME.DROMO.PARTOGRAPH.APP.Droid.Converters"
             xmlns:modals="clr-namespace:MAAME.DROMO.PARTOGRAPH.APP.Droid.Pages.Modals"
             xmlns:pagemodels="clr-namespace:MAAME.DROMO.PARTOGRAPH.APP.Droid.PageModels"
             Title="Third Stage Partograph">

    <ContentPage.Resources>
        <ResourceDictionary>
            <!-- Converters -->
            <converters:GreaterThanZeroConverter x:Key="GreaterThanZeroConverter" />
            <converters:EqualConverter x:Key="EqualConverter" />
            <converters:GramsToKilogramsConverter x:Key="GramsToKilogramsConverter" />
            <converters:IsNotNullConverter x:Key="IsNotNullConverter" />

            <!-- Colors -->
            <Color x:Key="PrimaryBlue">#2196F3</Color>
            <Color x:Key="SuccessGreen">#4CAF50</Color>
            <Color x:Key="WarningOrange">#FF9800</Color>
            <Color x:Key="DangerRed">#F44336</Color>
            <Color x:Key="Purple">#9C27B0</Color>

            <!-- Modern Card Style -->
            <Style x:Key="ModernCardStyle" TargetType="Border">
                <Setter Property="StrokeThickness" Value="0" />
                <Setter Property="BackgroundColor" Value="{AppThemeBinding Light=White, Dark=#1E293B}" />
                <Setter Property="Padding" Value="16" />
                <Setter Property="StrokeShape">
                    <RoundRectangle CornerRadius="16" />
                </Setter>
                <Setter Property="Shadow">
                    <Shadow Brush="{AppThemeBinding Light=#10000000, Dark=#30000000}"
                            Offset="0,4"
                            Radius="16"
                            Opacity="0.12" />
                </Setter>
            </Style>

            <!-- Section Title Style -->
            <Style x:Key="SectionTitleStyle" TargetType="Label">
                <Setter Property="FontSize" Value="16" />
                <Setter Property="FontAttributes" Value="Bold" />
                <Setter Property="TextColor" Value="{AppThemeBinding Light=#1E293B, Dark=#F8FAFC}" />
                <Setter Property="Margin" Value="0,0,0,8" />
            </Style>

            <!-- Vital Button Style -->
            <Style x:Key="VitalButtonStyle" TargetType="Button">
                <Setter Property="HeightRequest" Value="44" />
                <Setter Property="CornerRadius" Value="10" />
                <!--<Setter Property="FontSize" Value="13" />-->
                <Setter Property="Padding" Value="12,8" />
            </Style>
        </ResourceDictionary>
    </ContentPage.Resources>

    <ContentPage.ToolbarItems>
        <ToolbarItem Text="Refresh"
                     Command="{Binding RefreshCommand}"
                     IconImageSource="{x:Static fonts:FluentUI.arrow_sync_16_regular}" />
        <ToolbarItem Text="Add Baby"
                     Command="{Binding AddBabyCommand}"
                     IconImageSource="{x:Static fonts:FluentUI.person_add_16_regular}"
                     ToolTipProperties.Text="Add Baby Details" />
        <ToolbarItem Text="Print"
                     Command="{Binding PrintCommand}"
                     IconImageSource="{x:Static fonts:FluentUI.print_16_regular}" />
    </ContentPage.ToolbarItems>

    <Grid>
        <ScrollView>
            <VerticalStackLayout Padding="12" Spacing="12">

                <!-- Patient Header -->
                <Border StrokeThickness="0"
                        BackgroundColor="{AppThemeBinding Light=#E3F2FD, Dark=#1565C0}"
                        Padding="16">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="12" />
                    </Border.StrokeShape>
                    <Grid ColumnDefinitions="*,Auto">
                        <VerticalStackLayout Spacing="4">
                            <Label Text="{Binding PatientName}"
                                   FontSize="20"
                                   FontAttributes="Bold"
                                   TextColor="{AppThemeBinding Light=#1E293B, Dark=White}" />
                            <Label Text="{Binding PatientInfo}" 
                                   TextColor="{AppThemeBinding Light=#475569, Dark=#E0E0E0}" />
                            <HorizontalStackLayout Spacing="16" Margin="0,8,0,0">
                                <HorizontalStackLayout Spacing="4">
                                    <Label Text="{x:Static fonts:FluentUI.timer_16_regular}"
                                           FontFamily="FluentUI" 
                                           TextColor="{AppThemeBinding Light=#2196F3, Dark=#90CAF9}"
                                           VerticalOptions="Center" />
                                    <Label Text="{Binding ThirdStageDuration}" 
                                           FontAttributes="Bold"
                                           TextColor="{AppThemeBinding Light=#1E293B, Dark=White}" />
                                </HorizontalStackLayout>
                                <Label Text="{Binding LastRecordedTime, StringFormat='Last: {0:HH:mm}'}" 
                                       TextColor="{AppThemeBinding Light=#64748B, Dark=#B0BEC5}" />
                            </HorizontalStackLayout>
                        </VerticalStackLayout>
                        <VerticalStackLayout Grid.Column="1" VerticalOptions="Center" HorizontalOptions="End">
                            <Border BackgroundColor="{StaticResource SuccessGreen}"
                                    StrokeThickness="0"
                                    Padding="12,6">
                                <Border.StrokeShape>
                                    <RoundRectangle CornerRadius="8" />
                                </Border.StrokeShape>
                                <Label Text="STAGE 3" 
                                       FontAttributes="Bold"
                                       TextColor="{StaticResource PrimaryBlue}"
                                       HorizontalOptions="Center" />
                            </Border>
                            <Label Text="Placenta Delivery" 
                                   HorizontalOptions="Center"
                                   TextColor="{AppThemeBinding Light=#64748B, Dark=#B0BEC5}"
                                   Margin="0,4,0,0" />
                        </VerticalStackLayout>
                    </Grid>
                </Border>

                <!-- Alert Banner (if any) -->
                <Border IsVisible="{Binding HasAlert}"
                        BackgroundColor="{Binding AlertColor}"
                        StrokeThickness="0">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="10" />
                    </Border.StrokeShape>
                    <HorizontalStackLayout Spacing="8">
                        <Label Text="{x:Static fonts:FluentUI.warning_16_regular}"
                               FontFamily="FluentUI"
                               FontSize="18"
                               VerticalOptions="Center" />
                        <Label Text="{Binding AlertMessage}" 
                               FontAttributes="Bold"
                               VerticalOptions="Center" />
                    </HorizontalStackLayout>
                </Border>

                <!-- WHO 2020 Info Box -->
                <Border StrokeThickness="1"
                        Stroke="{AppThemeBinding Light=#3B82F6, Dark=#60A5FA}"
                        BackgroundColor="{AppThemeBinding Light=#EFF6FF, Dark=#1E3A8A}"
                        Padding="12">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="10" />
                    </Border.StrokeShape>
                    <VerticalStackLayout Spacing="6">
                        <Label Text="Third Stage Monitoring" 
                               FontAttributes="Bold"
                               TextColor="{AppThemeBinding Light=#1E40AF, Dark=#DBEAFE}" />
                        <Label TextColor="{AppThemeBinding Light=#1E40AF, Dark=#BFDBFE}">
                            <Label.FormattedText>
                                <FormattedString>
                                    <Span Text="Monitor: " FontAttributes="Bold" />
                                    <Span Text="Placenta delivery (&lt;30min), blood loss, uterine tone, BP, Pulse, Temperature" />
                                </FormattedString>
                            </Label.FormattedText>
                        </Label>
                    </VerticalStackLayout>
                </Border>

                <!-- Maternal Vitals Monitoring Card -->
                <Border Style="{StaticResource ModernCardStyle}">
                    <VerticalStackLayout Spacing="12">
                        <HorizontalStackLayout Spacing="8">
                            <Label Text="{x:Static fonts:FluentUI.heart_pulse_20_regular}"
                                   FontFamily="{x:Static fonts:FluentUI.FontFamily}"
                                   FontSize="18"
                                   TextColor="{StaticResource DangerRed}"
                                   VerticalOptions="Center" />
                            <Label Text="Maternal Vitals"
                                   Style="{StaticResource SectionTitleStyle}"
                                   Margin="0" />
                        </HorizontalStackLayout>

                        <!-- BP/Pulse Row -->
                        <Grid ColumnDefinitions="*,Auto,Auto" RowDefinitions="Auto,Auto" ColumnSpacing="10" RowSpacing="8">
                            <!-- BP Display -->
                            <VerticalStackLayout Grid.Row="0" Grid.Column="0">
                                <Label Text="Blood Pressure" TextColor="{AppThemeBinding Light=#64748B, Dark=#94A3B8}" />
                                <HorizontalStackLayout Spacing="8">
                                    <Label Text="{Binding BpLatestValue}"
                                           FontSize="18"
                                           FontAttributes="Bold"
                                           TextColor="{Binding BpButtonColor}" />
                                    <Label Text="{Binding BpStatusText}" 
                                           FontSize="18"
                                           TextColor="{Binding BpButtonColor}" />
                                </HorizontalStackLayout>
                            </VerticalStackLayout>
                            <Button Grid.Row="0" Grid.Column="1"
                                    Text="Record"
                                    Command="{Binding RecordBpPulseCommand}"
                                    BackgroundColor="{StaticResource DangerRed}"
                                    TextColor="White"
                                    Style="{StaticResource VitalButtonStyle}" />
                            <Button Grid.Row="0" Grid.Column="2"
                                    Text="Trend"
                                    Command="{Binding ShowBpTrendCommand}"
                                    BackgroundColor="{AppThemeBinding Light=#E2E8F0, Dark=#334155}"
                                    TextColor="{AppThemeBinding Light=#475569, Dark=#E2E8F0}"
                                    Style="{StaticResource VitalButtonStyle}" />

                            <!-- Pulse Display -->
                            <VerticalStackLayout Grid.Row="1" Grid.Column="0">
                                <Label Text="Pulse" TextColor="{AppThemeBinding Light=#64748B, Dark=#94A3B8}" />
                                <HorizontalStackLayout Spacing="8">
                                    <Label Text="{Binding PulseLatestValue}"
                                           FontSize="18"
                                           FontAttributes="Bold"
                                           TextColor="{Binding PulseButtonColor}" />
                                    <Label Text="{Binding PulseStatusText}"
                                           FontSize="18"
                                           TextColor="{Binding PulseButtonColor}" />
                                </HorizontalStackLayout>
                            </VerticalStackLayout>
                        </Grid>

                        <BoxView HeightRequest="1" Color="{AppThemeBinding Light=#E2E8F0, Dark=#334155}" Margin="0,4" />

                        <!-- Temperature Row -->
                        <Grid ColumnDefinitions="*,Auto,Auto" ColumnSpacing="10">
                            <VerticalStackLayout>
                                <Label Text="Temperature" TextColor="{AppThemeBinding Light=#64748B, Dark=#94A3B8}" />
                                <HorizontalStackLayout Spacing="8">
                                    <Label Text="{Binding TemperatureLatestValue}"
                                           FontSize="18"
                                           FontAttributes="Bold"
                                           TextColor="{Binding TemperatureButtonColor}" />
                                    <Label Text="{Binding TemperatureStatusText}"
                                           FontSize="18"
                                           TextColor="{Binding TemperatureButtonColor}" />
                                </HorizontalStackLayout>
                            </VerticalStackLayout>
                            <Button Grid.Column="1"
                                    Text="Record"
                                    Command="{Binding RecordTemperatureCommand}"
                                    BackgroundColor="{StaticResource WarningOrange}"
                                    TextColor="White"
                                    Style="{StaticResource VitalButtonStyle}" />
                            <Button Grid.Column="2"
                                    Text="Trend"
                                    Command="{Binding ShowTemperatureTrendCommand}"
                                    BackgroundColor="{AppThemeBinding Light=#E2E8F0, Dark=#334155}"
                                    TextColor="{AppThemeBinding Light=#475569, Dark=#E2E8F0}"
                                    Style="{StaticResource VitalButtonStyle}" />
                        </Grid>
                    </VerticalStackLayout>
                </Border>

                <!-- Third Stage Data Cards Grid -->
                <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto" ColumnSpacing="10" RowSpacing="10">

                    <!-- Placenta Status Card -->
                    <Border Grid.Row="0" Grid.Column="0" Style="{StaticResource ModernCardStyle}">
                        <VerticalStackLayout Spacing="8">
                            <Label Text="Placenta Status" Style="{StaticResource SectionTitleStyle}" />
                            <Label Text="{Binding PlacentaStatus}" 
                                   FontAttributes="Bold"
                                   TextColor="{Binding PlacentaStatusColor}" />
                            <Button Text="{Binding IsPlacentaDelivered, Converter={StaticResource IsNotNullConverter}, ConverterParameter='Edit|Record'}"
                                    Command="{Binding RecordPlacentaDeliveryCommand}"
                                    BackgroundColor="{StaticResource PrimaryBlue}"
                                    TextColor="White"
                                    HeightRequest="40"
                                    CornerRadius="8" />
                        </VerticalStackLayout>
                    </Border>

                    <!-- Blood Loss Card -->
                    <Border Grid.Row="0" Grid.Column="1" Style="{StaticResource ModernCardStyle}">
                        <VerticalStackLayout Spacing="8">
                            <Label Text="Estimated Blood Loss" Style="{StaticResource SectionTitleStyle}" />
                            <Label Text="{Binding BloodLoss}" 
                                   FontAttributes="Bold"
                                   TextColor="{Binding BloodLossColor}" />
                            <Label Text="Normal: &lt;500 mL" 
                                   TextColor="{AppThemeBinding Light=#64748B, Dark=#94A3B8}" />
                        </VerticalStackLayout>
                    </Border>

                    <!-- Uterine Status Card -->
                    <Border Grid.Row="1" Grid.Column="0" Style="{StaticResource ModernCardStyle}">
                        <VerticalStackLayout Spacing="8">
                            <Label Text="Uterine Tone" Style="{StaticResource SectionTitleStyle}" />
                            <Label Text="{Binding UterineStatus}" 
                                   FontAttributes="Bold"
                                   TextColor="{Binding UterineStatusColor}" />
                            <Label Text="Monitor for firmness" 
                                   TextColor="{AppThemeBinding Light=#64748B, Dark=#94A3B8}" />
                        </VerticalStackLayout>
                    </Border>

                    <!-- Active Management Card -->
                    <Border Grid.Row="1" Grid.Column="1" Style="{StaticResource ModernCardStyle}">
                        <VerticalStackLayout Spacing="8">
                            <Label Text="Active Management" Style="{StaticResource SectionTitleStyle}" />
                            <Label Text="{Binding ActiveManagementStatus}" 
                                   FontAttributes="Bold"
                                   TextColor="{StaticResource SuccessGreen}" />
                            <Label Text="WHO: 10 IU Oxytocin IM" 
                                   TextColor="{AppThemeBinding Light=#64748B, Dark=#94A3B8}" />
                        </VerticalStackLayout>
                    </Border>
                </Grid>

                <!-- Babies Section -->
                <Border Style="{StaticResource ModernCardStyle}">
                    <VerticalStackLayout Spacing="12">
                        <!-- Header with Add Button -->
                        <Grid ColumnDefinitions="*,Auto">
                            <HorizontalStackLayout Spacing="8">
                                <Label Text="{x:Static fonts:FluentUI.people_16_regular}"
                                       FontFamily="FluentUI"
                                       FontSize="18"
                                       TextColor="{StaticResource SuccessGreen}"
                                       VerticalOptions="Center" />
                                <Label Text="Babies"
                                       Style="{StaticResource SectionTitleStyle}"
                                       Margin="0"
                                       VerticalOptions="Center"/>
                                <Border BackgroundColor="{StaticResource PrimaryBlue}"
                                        StrokeThickness="0"
                                        Padding="8,2"

                                        IsVisible="{Binding HasBabies}">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="10" />
                                    </Border.StrokeShape>
                                    <Label Text="{Binding BabyCount}" 
                                           FontAttributes="Bold"
                                           TextColor="White" />
                                </Border>
                            </HorizontalStackLayout>
                            <Button Grid.Column="1"
                                    Text="+ Add Baby"
                                    Command="{Binding AddBabyCommand}"
                                    BackgroundColor="{StaticResource SuccessGreen}"
                                    TextColor="White"
                                    HeightRequest="36"
                                    CornerRadius="8" 
                                    Padding="12,6" />
                        </Grid>

                        <!-- No Babies Message -->
                        <Border IsVisible="{Binding Babies.Count, Converter={StaticResource EqualConverter}, ConverterParameter=0}"
                                BackgroundColor="{AppThemeBinding Light=#F8FAFC, Dark=#0F172A}"
                                StrokeThickness="1"
                                Stroke="{AppThemeBinding Light=#E2E8F0, Dark=#334155}"
                                Padding="20">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="10" />
                            </Border.StrokeShape>
                            <VerticalStackLayout Spacing="8" HorizontalOptions="Center">
                                <Label Text="{x:Static fonts:FluentUI.person_add_16_regular}"
                                       FontFamily="FluentUI"
                                       FontSize="32"
                                       TextColor="{AppThemeBinding Light=#94A3B8, Dark=#64748B}"
                                       HorizontalOptions="Center" />
                                <Label Text="No babies recorded yet" 
                                       TextColor="{AppThemeBinding Light=#64748B, Dark=#94A3B8}"
                                       HorizontalOptions="Center" />
                                <Label Text="Tap '+ Add Baby' to record baby details" 
                                       TextColor="{AppThemeBinding Light=#94A3B8, Dark=#64748B}"
                                       HorizontalOptions="Center" />
                            </VerticalStackLayout>
                        </Border>

                        <!-- Babies List -->
                        <CollectionView ItemsSource="{Binding Babies}"
                                        IsVisible="{Binding HasBabies}">
                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <Border Stroke="{AppThemeBinding Light=#E2E8F0, Dark=#334155}"
                                            StrokeThickness="1"
                                            BackgroundColor="{AppThemeBinding Light=#F8FAFC, Dark=#0F172A}"
                                            Padding="12"
                                            Margin="0,4">
                                        <Border.StrokeShape>
                                            <RoundRectangle CornerRadius="10" />
                                        </Border.StrokeShape>
                                        <Grid RowDefinitions="Auto,Auto" ColumnDefinitions="*,Auto" RowSpacing="8">
                                            <!-- Baby Info -->
                                            <VerticalStackLayout Grid.Row="0" Grid.Column="0" Spacing="4">
                                                <HorizontalStackLayout Spacing="8">
                                                    <Label Text="{Binding BabyTag}" 
                                                           FontAttributes="Bold"
                                                           VerticalOptions="Center"
                                                           TextColor="{AppThemeBinding Light=#1E293B, Dark=#F8FAFC}" />
                                                    <Border BackgroundColor="{AppThemeBinding Light=#DBEAFE, Dark=#1E3A8A}"
                                                            StrokeThickness="0"
                                                            Padding="6,2">
                                                        <Border.StrokeShape>
                                                            <RoundRectangle CornerRadius="6" />
                                                        </Border.StrokeShape>
                                                        <Label Text="{Binding Sex}" 
                                                               VerticalOptions="Center"
                                                               TextColor="{AppThemeBinding Light=#1E40AF, Dark=#BFDBFE}" />
                                                    </Border>
                                                </HorizontalStackLayout>
                                                <!--, Converter={StaticResource GramsToKilogramsConverter}-->
                                                <HorizontalStackLayout Spacing="16">
                                                    <Label TextColor="{AppThemeBinding Light=#64748B, Dark=#94A3B8}" VerticalOptions="Center">
                                                        <Label.FormattedText>
                                                            <FormattedString>
                                                                <Span Text="Weight: " />
                                                                <Span Text="{Binding BirthWeight}" FontAttributes="Bold" />
                                                                <Span Text="kg" />
                                                            </FormattedString>
                                                        </Label.FormattedText>
                                                    </Label>
                                                    <Label Text="{Binding VitalStatus}" 
                                                           TextColor="{StaticResource SuccessGreen}" />
                                                </HorizontalStackLayout>
                                            </VerticalStackLayout>

                                            <!-- APGAR Scores -->
                                            <HorizontalStackLayout Grid.Row="0" Grid.Column="1" Spacing="6" VerticalOptions="Center">
                                                <Border BackgroundColor="{AppThemeBinding Light=#DCFCE7, Dark=#14532D}"
                                                        StrokeThickness="0"
                                                        Padding="8,4"
                                                        IsVisible="{Binding Apgar1Min, Converter={StaticResource IsNotNullConverter}}">
                                                    <Border.StrokeShape>
                                                        <RoundRectangle CornerRadius="6" />
                                                    </Border.StrokeShape>
                                                    <Label TextColor="{AppThemeBinding Light=#166534, Dark=#BBF7D0}">
                                                        <Label.FormattedText>
                                                            <FormattedString>
                                                                <Span Text="1min: " />
                                                                <Span Text="{Binding Apgar1Min}" FontAttributes="Bold" />
                                                            </FormattedString>
                                                        </Label.FormattedText>
                                                    </Label>
                                                </Border>
                                                <Border BackgroundColor="{AppThemeBinding Light=#DCFCE7, Dark=#14532D}"
                                                        StrokeThickness="0"
                                                        Padding="8,4"
                                                        IsVisible="{Binding Apgar5Min, Converter={StaticResource IsNotNullConverter}}">
                                                    <Border.StrokeShape>
                                                        <RoundRectangle CornerRadius="6" />
                                                    </Border.StrokeShape>
                                                    <Label TextColor="{AppThemeBinding Light=#166534, Dark=#BBF7D0}">
                                                        <Label.FormattedText>
                                                            <FormattedString>
                                                                <Span Text="5min: " />
                                                                <Span Text="{Binding Apgar5Min}" FontAttributes="Bold" />
                                                            </FormattedString>
                                                        </Label.FormattedText>
                                                    </Label>
                                                </Border>
                                            </HorizontalStackLayout>

                                            <!-- Action Buttons -->
                                            <!--Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.RecordBabyApgarCommand}"-->

                                            <HorizontalStackLayout Grid.Row="1" Grid.ColumnSpan="2" Spacing="8" HorizontalOptions="End">
                                                <Button Text="Record APGAR"
                                                        Command="{Binding Source={RelativeSource AncestorType={x:Type pagemodels:ThirdStagePartographPageModel}}, Path=RecordBabyApgarCommand, x:DataType=pagemodels:ThirdStagePartographPageModel}"
                                                        CommandParameter="{Binding .}"
                                                        BackgroundColor="{StaticResource SuccessGreen}"
                                                        TextColor="White"
                                                        HeightRequest="32"
                                                        CornerRadius="6" 
                                                        Padding="10,4" />
                                                <!--Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.ViewBabyDetailsCommand}"-->

                                                <Button Text="View Details"
                                                        Command="{Binding Source={RelativeSource AncestorType={x:Type pagemodels:ThirdStagePartographPageModel}}, Path=ViewBabyDetailsCommand, x:DataType=pagemodels:ThirdStagePartographPageModel}"
                                                        CommandParameter="{Binding .}"
                                                        BackgroundColor="{StaticResource PrimaryBlue}"
                                                        TextColor="White"
                                                        HeightRequest="32"
                                                        CornerRadius="6" 
                                                        Padding="10,4" />
                                            </HorizontalStackLayout>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>
                    </VerticalStackLayout>
                </Border>

                <!-- Transition Button -->
                <Button Text="Transition to Fourth Stage (Immediate Postpartum)"
                        Command="{Binding TransitionToFourthStageCommand}"
                        BackgroundColor="{StaticResource Purple}"
                        TextColor="White" 
                        FontAttributes="Bold"
                        HeightRequest="54"
                        CornerRadius="12"
                        Margin="0,8,0,20" />

            </VerticalStackLayout>
        </ScrollView>

        <!-- Popups -->
        <modals:PlacentaDeliveryPopup x:Name="PlacentaDeliveryPopup"
                                       BindingContext="{Binding PlacentaDeliveryPopupPageModel}"
                                       StaysOpen="True"
                                       ShowCloseButton="True"
                                       WidthRequest="340"
                                       HeightRequest="650"
                                       HeaderHeight="60" />

        <modals:BpPulsePopup x:Name="BpPulsePopup"
                             BindingContext="{Binding BPPulseModalPageModel}"
                             StaysOpen="True"
                             ShowCloseButton="True"
                             WidthRequest="320"
                             HeightRequest="600"
                             HeaderHeight="50" />

        <modals:TemperaturePopup x:Name="TemperaturePopup"
                                  BindingContext="{Binding TemperatureModalPageModel}"
                                  StaysOpen="True"
                                  ShowCloseButton="True"
                                  WidthRequest="320"
                                  HeightRequest="450"
                                  HeaderHeight="50" />

        <modals:VitalsTrendPopup x:Name="VitalsTrendPopup"
                                  BindingContext="{Binding .}"
                                  StaysOpen="True"
                                  ShowCloseButton="True"
                                  WidthRequest="360"
                                  HeightRequest="450"
                                  HeaderHeight="50" />

        <modals:TemperatureTrendPopup x:Name="TemperatureTrendPopup"
                                       BindingContext="{Binding .}"
                                       StaysOpen="True"
                                       ShowCloseButton="True"
                                       WidthRequest="360"
                                       HeightRequest="450"
                                       HeaderHeight="50" />

    </Grid>
</ContentPage>
